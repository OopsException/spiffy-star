---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_TITLE } from '../consts';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');

// Sort newest first
posts.sort((a, b) => Number(new Date(b.data.pubDate)) - Number(new Date(a.data.pubDate)));
---
<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={"Sharing coffee, knowledge & culture"} />

		<!-- Inter font for editorial typography on the index page -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

		<style>
			/* Page-scoped minimal editorial styles using Inter */
			.cc-hero {
				text-align: center;
				/* Reduced top padding to sit closer to header while keeping balanced whitespace */
				padding: 3rem 1rem 2rem;
				font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
				background: transparent;
			}
			.cc-title {
				margin: 0 auto;
				font-weight: 700;
				/* Fluid size so title scales down on small screens without awkward wrapping */
				font-size: clamp(1.8rem, 4vw, 2.5rem);
				letter-spacing: -0.02em;
				color: var(--text);
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}
			.cc-sub {
				margin-top: 0.75rem;
				color: var(--text-muted);
				font-weight: 300;
				font-size: 1.05rem;
			}

			.posts {
				max-width: 720px;
				margin: 2.5rem auto 6rem;
				padding: 0 1rem;
				font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
			}
			.post {
				padding: 1.25rem 0;
				border-top: 1px solid var(--border);
			}
			.post:first-of-type { border-top: none; padding-top: 0; }
			.post a {
				color: var(--text);
				font-weight: 600;
				text-decoration: none;
				font-size: 1.05rem;
				display: block;
			}
			.post a:hover { text-decoration: underline; }
			.post p { margin: 0.5rem 0 0; color: var(--text-muted); font-size: 0.99rem; }

			@media (max-width: 720px) {
				/* Slightly tighter spacing on small screens to keep header & hero close */
				.cc-hero { padding: 2rem 1rem 1.25rem; }
				.posts { margin-top: 1.25rem; }
			}
		</style>
	</head>
	<body>
		<Header />

		<main>
			<header class="cc-hero" role="banner">
				<h1 class="cc-title">Coffee Community LB</h1>
				<p class="cc-sub">Sharing coffee, knowledge &amp; culture</p>

			</header>

			<section class="posts" aria-labelledby="latest-posts">
				<h2 id="latest-posts" style="position:absolute;left:-9999px;">Latest posts</h2>

				{posts.length === 0 ? (
					<p style="text-align:center;color:var(--text-muted);padding:2rem 1rem;">No posts yet.</p>
				) : (
					posts.slice(0, 5).map((post) => (
						<article class="post">
							<a href={`/blog/${post.id}`}>{post.data.title}</a>
							{post.data.description ? <p>{post.data.description}</p> : null}
						</article>
					))
				)
				}
			</section>

		</main>

		<Footer />
	</body>
</html>